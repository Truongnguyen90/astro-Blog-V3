---
import { getCollection } from "astro:content";
import BaseLayout from "./BaseLayout.astro";
import SubscribeCta from "@/components/blog/SubscribeCta.astro";
import EntriesTwo from "@/components/blog/EntriesTwo.astro";
const { frontmatter } = Astro.props;
const allPosts = await getCollection("posts");
---

<BaseLayout>
  <!-- Scroll to Top Button -->
  <div
    x-data="{ isVisible: false }"
    x-init="window.addEventListener('scroll', () => { isVisible = window.scrollY > 100; })"
    class="fixed bottom-6 right-6 z-50"
    x-show="isVisible"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 transform translate-y-2"
    x-transition:enter-end="opacity-100 transform translate-y-0"
    x-transition:leave="transition ease-in duration-300"
    x-transition:leave-start="opacity-100 transform translate-y-0"
    x-transition:leave-end="opacity-0 transform translate-y-2">
    <button
      @click="window.scrollTo({ top: 0, behavior: 'smooth' })"
      class="justify-center rounded-xl shadow-3xl size-12 bg-white flex items-center font-semibold text-black hover:bg-zinc-200 duration-300 ring-1 ring-inset ring-zinc-200">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-narrow-up size-6"
        ><path
          stroke="none"
          d="M0 0h24v24H0z"
          fill="none"
        ></path><path d="M12 5l0 14"></path><path d="M16 9l-4 -4"></path><path
          d="M8 9l4 -4"></path></svg
      >
    </button>
  </div>
  <section>
    <div class="px-8 py-24 mx-auto">
      <div class="text-center max-w-lg mx-auto">
        <h1
          class="text-4xl text-balance text-white md:text-5xl font-display italic tracking-wide">
          {frontmatter.title}
        </h1>
        <p class="text-zinc-500 dark:text-zinc-400 text-xs mt-2">
          Published: <time
            datetime={frontmatter.pubDate.toString().slice(0, 15)}>
            {frontmatter.pubDate.toString().slice(0, 15)} by {
              frontmatter.author
            }
          </time>
        </p>
        <p class="mt-8 text-base font-medium text-zinc-400 text-balance">
          {frontmatter.description}
        </p>
      </div>
      <div class="max-w-xl mx-auto space-y-6">
        <img
          class="rounded-2xl shadow-3xl max-h-72 mt-6 ring-1 ring-zinc-200 dark:ring-zinc-800 w-full object-cover object-center"
          src={frontmatter.image.url}
          alt={frontmatter.image.alt}
        />
        <div class="prose-styles mx-auto">
          <slot />
          <div class="flex flex-wrap gap-2 mt-6 max-w-xl mx-auto">
            {
              frontmatter.tags.map((tag) => (
                <a href={`/blog/tags/${tag}`}>{tag}</a>
              ))
            }
          </div>
        </div>
      </div>
    </div>
  </section>
  <SubscribeCta />
  <section>
    <div class="px-8 py-24 mx-auto">
      <div class="text-center max-w-xl mx-auto">
        <div class="flex justify-between items-center">
          <p
            class="text-2xl font-display italic tracking-wide text-white">
           Latest Articles
          </p>
          <a
            class="hover:text-blue-400 flex items-center gap-2 group text-zinc-400"
            href="/blog/home-two"
            >See them all <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-right size-4 group-hover:translate-x-2 duration-300"
              ><path
                stroke="none"
                d="M0 0h24v24H0z"
                fill="none"
              ></path><path d="M9 6l6 6l-6 6"></path></svg
            ></a
          >
        </div>
      </div>
      <ul
        role="list"
        class="grid sm:grid-cols-2 gap-2 mt-6 max-w-xl mx-auto">
        {
          allPosts.slice(0,2).map((post) => (
            <EntriesTwo
              url={"/blog/posts/" + post.slug}
              title={post.data.title}
              description={post.data.description}
              alt={post.data.title}
              pubDate={post.data.pubDate.toString().slice(0, 10)}
              author={post.data.author}
              image={post.data.image.url}
            />
          ))
        }
      </ul>
    </div>
  </section>
</BaseLayout>
