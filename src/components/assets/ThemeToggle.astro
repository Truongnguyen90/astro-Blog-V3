---
// Icons
import Toggle from "@/components/fundations/icons/Toggle.astro";
---
<button
  class="fixed z-50 flex items-center justify-center font-semibold shadow-lg text-base-900 duration-300 rounded-xl size-12 bg-base-50 hover:bg-base-200 dark:bg-base-800 dark:hover:bg-base-900 dark:text-white dark:ring-base-800 ring-1 ring-inset ring-base-200 transition-opacity bottom-1 left-1 lg:bottom-4 lg:left-4"
  role="switch"
  aria-checked="false"
  id="theme-toggle"
>
  <!-- Single SVG Icon -->
  <Toggle class="dark:text-white text-base-900 size-5" />
</button>
<script>
  const toggle = document.getElementById("theme-toggle");
  function updateTheme(isDark) {
    // Toggle dark mode class on the root HTML element
    document.documentElement.classList.toggle("dark", isDark);
    toggle.setAttribute("aria-checked", isDark ? "true" : "false");
    // Save the user's theme preference in localStorage
    localStorage.setItem("theme", isDark ? "dark" : "light");
  }
  // Initialize theme based on localStorage or system preference
  function initializeTheme() {
    const savedTheme = localStorage.getItem("theme");
    const systemPrefersDark = window.matchMedia(
      "(prefers-color-scheme: dark)"
    ).matches;
    const isDark = savedTheme ? savedTheme === "dark" : systemPrefersDark;
    updateTheme(isDark);
  }
  // Run initialization when page loads
  initializeTheme();
  // Handle toggle click event
  toggle.addEventListener("click", () => {
    const isDark = toggle.getAttribute("aria-checked") === "true";
    updateTheme(!isDark);
  });
</script>
